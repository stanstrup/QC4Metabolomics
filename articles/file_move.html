<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Moving raw files automatically • MetabolomiQCsR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Moving raw files automatically">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MetabolomiQCsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/demo.html">Demo</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/demo.html">Running the demo</a></li>
    <li><a class="dropdown-item" href="../articles/setup_own_system.html">Running your own system</a></li>
    <li><a class="dropdown-item" href="../articles/file_move.html">Moving raw files automatically</a></li>
    <li><a class="dropdown-item" href="../articles/installing_docker_on_redhat.html">Installing Docker on RedHat</a></li>
    <li><a class="dropdown-item" href="../articles/scheduling.html">How are tasks scheduled?</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Maintainance</h6></li>
    <li><a class="dropdown-item" href="../articles/update_database.html">Upgrading the database version</a></li>
    <li><a class="dropdown-item" href="../articles/connect_to_db_from_R.html">Connect to DB in R</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/stanstrup/QC4Metabolomics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Moving raw files automatically</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stanstrup/QC4Metabolomics/blob/master/vignettes/articles/file_move.Rmd"><code>vignettes/articles/file_move.Rmd</code></a></small>
      <div class="d-none name"><code>file_move.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>These (<code>file_mover</code>) are helper scripts that are not part
of the system as such. The purpose is to solve the situation where the
LC-MS instrument computer is not reachable by the QC system but they can
both access a shared network drive. This windows batch script can be
used to copy the .raw folders to the network drive and is written to
wait for the analysis to finish.<br></p>
<p><strong>These scripts are written for Waters’ .raw folder and should
not be used directly for anything else.</strong><br><strong>I advise against using this script if you are not able to
double-check what it is doing yourself and make sure you have backups
before you try it.</strong><br></p>
<p>What the script is meant to do:</p>
<ul>
<li>Monitor when a run is done.</li>
<li>Will check if the filename (really a folder name) has the expected
number of delimiters.</li>
<li>If the filename is in the right format the file will be
<em>moved</em> (that is deleted from the original location!) to the
given location.<br><strong>THIS IS POTENTIALLY DESTRUCTIVE. BACKUP BEFORE
TESTING!!!</strong><br><strong>This script was written for the metabolomics group at NEXS and
there are therefore specific parsing of the filename to decide the
destination folder.</strong>
</li>
<li>The first string before the first delimiter is used as the project
name and a project folder is create such that the file
<code>%infolder%\test-pro_pos_test-sample-metstd.raw</code> will be
moved to
<code>%outfolder%\test-pro.raw\Data\test-pro_pos_test-sample-metstd.raw</code>
</li>
<li>
<em>Optionally</em> symlinks can be made from the original location
to the destination folder. This way you can still access the file as if
it was still in the original place even if it is actually access in the
destination location. So you can open the file normally in the
instrument software that expect the file to exist at the original
location.</li>
<li>
<em>Optionally</em> the above mentioned symlinks can be cleared by
running a script
(<code>file_mover/clear_symlink_folders.bat</code>).</li>
</ul>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<ul>
<li><p>Copy the content of the <code>file_mover</code> folder to the
instrument computer where the .raw “files” are located.</p></li>
<li>
<p>Edit the top part of <code>win_waters_mover.bat</code> to point
to the right folders and the settings you want.</p>
<ul>
<li>
<code>infolder</code> and <code>outfolder</code> are the source and
destination folders respectively.</li>
<li>Like the QC system the file move expects to be able to parse
information from the file name. So <code>delim</code> sets the character
that separates the information.</li>
<li>
<code>expect_delims</code> states how many delimiters to expect in a
filename. This is used to only parse files with the expected filename
convention.</li>
<li>If <code>symlinkback</code> is TRUE a symbolic link will be made in
the original location pointing to the destination location.</li>
</ul>
</li>
<li>
<p><em>If you use symlinks</em> you need to:</p>
<ul>
<li>Right click on Start → Run and launch “secpol.msc”.</li>
<li>Open “Security Settings” → “Local Policies” → “User Rights
Assignment” and select “Create symbolic links”.</li>
<li>Click “Add User or Group…” → enter the username the system normally
uses → click “Check Names” → Click “OK” → Click “OK”</li>
<li>Reboot <em>or</em> log out and log in again (or run “gpupdate/force”
on the command-line as administrator).</li>
</ul>
</li>
<li><p>Edit <code>monitor_folder.bat</code> to point to the same input
folder as in <code>win_waters_mover.bat.</code></p></li>
<li><p>Run <code>enable_monitor_at_startup.bat</code>. This should make
the folder monitor start at reboot. A console windows will be visible if
this worked (after reboot).</p></li>
<li><p><em>If you used symlinks</em> you can always remove all symlinks
by running <code>clear_symlink_folders.bat</code>. Edit to set the
location first. This should be same location as <code>infolder</code> in
<code>win_waters_mover.bat</code>.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jan Stanstrup.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
